# 研究室名簿

## データベースの改良

#### 作業1

補完すべき項目を決める。

- ID
- 氏名
- 研究室名
- 研究室の場所

#### 作業2

サンプルデータを作る。

|ID |氏名|研究室名|研究室の場所|
|:--|:---|:-------|:-----------|
|1  |岩瀬|矢吹研|1号館907|
|2  |岩橋|矢吹研|1号館907|
|3  |大木|矢吹研|1号館907|
|4  |小山|矢吹研|1号館907|
|5  |Alice|下田研|1号館1105|

このデータを次のような二つのテーブルで管理する。

|ID |氏名|研究室ID|
|:--|:---|:-------|
|1  |岩瀬|1|
|2  |岩橋|1|
|3  |大木|1|
|4  |小山|1|
|5  |Alice|2|

|ID |研究室名|研究室の場所|
|:--|:---|:-------|
|1  |矢吹研|1号館907|
|2  |下田研|1号館1105|

#### 作業3

学生を格納するテーブル

|名前|型|その他|
|:---|:----------|:-----|
|id  |整数 int|主キー|
|name|50文字までの文字列 varchar(50)|-|
|lab_id|整数 int|-|

lab_idには外部キー制約を付け，研究室のIDとして存在する値しか入らないようにするべき。しかし，作業が面倒になるため，この演習では外部キーのことは考えなくてよい。

研究室を管理するテーブル

|名前|型|その他|
|:---|:----------|:-----|
|id  |整数 int|主キー|
|name|50文字までの文字列 varchar(50)|-|
|place|20文字までの文字列 varchar(20)|-|

テーブルを修正するのが正しい方法だが，ここでは簡単にするために，テーブルを一度削除して作り直す。`sample3.sql`を参照。

### 検索方法

テーブルが複数になってもデータの追加方法と更新方法は同じでよい。検索方法が変わる。テーブルを連結させる条件を書くことになる。`SELECT 項目 FROM テーブル1 JOIN テーブル2 ON 結合条件`。

二つのテーブルを結合する方法は次のとおり。（phpMyAdminで実行してみること。）

```sql
SELECT * FROM members JOIN labos ON members.lab_id=labos.id
```

必要なデータだけ取り出す。（名前が重複するから`AS`で名前を付け直す。）

```sql
SELECT
  members.id AS id,
  members.name AS name,
  labos.name AS labo,
  labos.place AS place
FROM members JOIN labos ON members.lab_id=labos.id
```

これをPHPで実行する。`all3.php`を参照。
